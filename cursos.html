<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nossos Cursos | FICV</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Main Styles -->
    <link rel="stylesheet" href="/style.css">
    <style>
        /* Courses Page Specific Styles */
        .page-hero {
            height: 350px;
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)),
                url('https://cursos.ficv.edu.br/wp-content/uploads/2025/11/FICV-Joao-Pessoa.jpg') center/cover no-repeat;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            margin-top: 80px;
        }

        .page-hero h1 {
            font-size: 3rem;
            color: white;
            font-weight: 300;
        }

        .page-hero h1 span {
            font-weight: 800;
            color: var(--color-secondary);
        }

        /* Filter Section */
        .filter-section {
            padding: 60px 0 40px;
            background: transparent;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .filter-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .filter-header h2 {
            font-size: 1.8rem;
            color: #fff;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .filter-header p {
            color: #ccc;
            max-width: 800px;
            margin: 0 auto;
        }

        .filter-tabs {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .filter-tab {
            padding: 10px 20px;
            font-size: 1rem;
            font-weight: 500;
            color: #aaa;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
        }

        .filter-tab:hover {
            color: var(--color-secondary);
        }

        .filter-tab.active {
            color: #fff;
            border-bottom-color: var(--color-secondary);
            font-weight: 700;
        }

        .filter-tab span.ead {
            color: #28a745;
            /* Green for EAD distinction */
            font-weight: 700;
        }

        /* Courses Grid */
        .courses-section {
            padding: 60px 0;
            background: transparent;
            min-height: 500px;
        }

        .courses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
        }

        /* Course Card Redesign */
        .course-card {
            background: #EFEFEF;
            /* Light gray background */
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.3s;
            display: flex;
            flex-direction: column;
            text-decoration: none;
            color: inherit;
            padding: 15px;
            /* Padding surrounding the content */
        }

        .course-card:hover {
            transform: translateY(-5px);
        }

        .course-image {
            height: 180px;
            background-size: cover;
            background-position: center;
            position: relative;
            border-radius: 8px;
            /* Inner rounded corners for image */
            overflow: hidden;
        }

        .course-badges {
            position: absolute;
            top: 10px;
            right: 10px;
            /* Positioned top-right inside image */
            left: auto;
            display: flex;
            gap: 5px;
        }

        .badge {
            background: #0d1e29;
            /* Dark background default */
            color: #fff;
            padding: 4px 12px;
            border-radius: 20px;
            /* Pill shape */
            font-size: 0.75rem;
            text-transform: capitalize;
            /* Or keep uppercase? Image shows 'Presencial' capitalized */
            font-weight: 700;
        }

        .badge.presencial {
            background: #0d1e29;
            /* Dark pill */
        }

        .badge.ead {
            background: #0d1e29;
            /* Dark pill for uniformity or green? Image showing 'EAD' in dark pill */
        }

        .course-content {
            padding: 15px 5px 5px;
            /* Spacing below image */
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .course-category {
            font-size: 0.9rem;
            color: #777;
            margin-bottom: 5px;
            font-weight: 400;
        }

        .course-title {
            font-size: 1.3rem;
            color: #0d1e29;
            /* Dark blue/black */
            font-weight: 800;
            /* Extra bold */
            margin-bottom: 0;
            line-height: 1.2;
        }

        .course-meta {
            display: none;
            /* Hide old meta info */
        }

        .card-loader {
            grid-column: 1 / -1;
            text-align: center;
            padding: 50px;
        }

        .card-loader {
            grid-column: 1 / -1;
            text-align: center;
            padding: 50px;
        }

        @media(max-width: 768px) {
            .page-hero h1 {
                font-size: 2.2rem;
            }

            .filter-tabs {
                gap: 10px;
            }

            .filter-tab {
                font-size: 0.9rem;
                padding: 10px;
            }
        }
    </style>
</head>

<body>

    <!-- Header -->
    <header id="main-header">
        <div class="container header-container">
            <div class="logo-wrapper">
                <a href="/" class="logo">
                    <img src="https://cursos.ficv.edu.br/wp-content/uploads/2025/02/logo-ficv.png" alt="FICV Logo">
                </a>
            </div>

            <div class="header-right">
                <div class="header-buttons">
                    <div class="dropdown-container">
                        <a href="#" class="btn btn-outline" style="font-size: 0.8rem; padding: 6px 12px;"><i
                                class="fas fa-graduation-cap"></i> Já sou Aluno</a>
                        <div class="dropdown-menu">
                            <div class="dropdown-menu-content">
                                <a href="#" class="dropdown-item" data-cms-href="header_student_ava_url"
                                    target="_blank">Ambiente Virtual</a>
                                <a href="#" class="dropdown-item" data-cms-href="header_student_portal_url"
                                    target="_blank">Portal do Aluno</a>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="menu-trigger" aria-label="Abrir menu">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Offcanvas Menu -->
    <div class="offcanvas-menu">
        <button class="close-menu">&times;</button>
        <div class="offcanvas-content">
            <div class="offcanvas-section">
                <div class="offcanvas-header">
                    <span class="small-title">Nossos</span>
                    <h2 class="large-title">Cursos</h2>
                </div>
                <nav>
                    <ul>
                        <li><a href="/cursos?type=graduacao">Graduação</a></li>
                        <li><a href="/cursos?type=pos-graduacao">Pós-Graduação</a></li>
                        <li><a href="/cursos?type=livres">Cursos Livres</a></li>
                        <li><a href="/cursos">Ver Todos</a></li>
                    </ul>
                </nav>
            </div>

            <div class="offcanvas-section">
                <div class="offcanvas-header">
                    <span class="small-title">Sobre nós</span>
                    <h2 class="large-title">Institucional</h2>
                </div>
                <nav>
                    <ul>
                        <li><a href="/quem-somos">Quem somos</a></li>
                        <li><a href="/estrutura">Estrutura</a></li>
                        <li><a href="https://ficv.i10bibliotecas.com.br/" target="_blank"
                                data-cms-href="nav_biblioteca_url">Biblioteca</a></li>
                        <li><a href="https://ficv.i10bibliotecas.com.br/ri" target="_blank"
                                data-cms-href="nav_repositorio_url">Repositório Institucional</a></li>
                        <li><a href="/npj">Núcleo de Prática Jurídica</a></li>
                        <li><a href="/noticias">Notícias</a></li>

                        <li><a href="https://diplomas.somosb4.com.br/validar" target="_blank"
                                data-cms-href="nav_validacao_diploma_url">Validação de Diploma</a></li>
                        <li><a href="/fale-conosco">Fale conosco</a></li>
                    </ul>
                </nav>
            </div>

            <!-- Section: Revista -->
            <div class="offcanvas-section">
                <div class="offcanvas-header">
                    <span class="small-title">Revista Acadêmica</span>
                    <h2 class="large-title">Summae Sapientiae</h2>
                </div>
                <nav>
                    <ul>
                        <li><a href="https://periodicos.ficv.edu.br/summaesapientiae" target="_blank"
                                data-cms-href="nav_revista_url">Acesse nossa Revista</a></li>
                    </ul>
                </nav>
            </div>

            <div class="offcanvas-section">
                <div class="offcanvas-header">
                    <span class="small-title">Siga-nos nas</span>
                    <h2 class="large-title">Redes Sociais</h2>
                </div>
                <div class="offcanvas-socials">
                    <a href="#" class="social-icon" data-cms-href="social_instagram" target="_blank"><i
                            class="fab fa-instagram"></i></a>
                    <a href="#" class="social-icon" data-cms-href="social_facebook" target="_blank"><i
                            class="fab fa-facebook"></i></a>
                    <a href="#" class="social-icon" data-cms-href="social_youtube" target="_blank"><i
                            class="fab fa-youtube"></i></a>
                    <a href="#" class="social-icon" data-cms-href="social_linkedin" target="_blank"><i
                            class="fab fa-linkedin"></i></a>
                </div>
            </div>
        </div>
    </div>

    <main>
        <!-- Hero -->
        <section class="page-hero">
            <div class="container">
                <h1>Nossos <span>Cursos</span></h1>
            </div>
        </section>

        <!-- Filters -->
        <section class="filter-section">
            <div class="container">
                <div class="filter-header">
                    <h2><i class="fas fa-search-dollar" style="display:none"></i> Conheça nossos cursos</h2>
                    <p>Confira os cursos da <strong>Faculdade Internacional Cidade Viva</strong>, cursos de graduação,
                        pós-graduação, livres e em diferentes modalidades de ensino. Escolha a modalidade abaixo:</p>
                </div>

                <div class="filter-tabs" id="course-tabs">
                    <button class="filter-tab active" data-filter="all">Todos</button>
                    <button class="filter-tab" data-filter="Graduação">Graduação</button>
                    <button class="filter-tab" data-filter="Graduação EAD">Graduação <span
                            class="ead">EAD</span></button>
                    <button class="filter-tab" data-filter="Pós-Graduação">Pós-Graduação</button>
                    <button class="filter-tab" data-filter="Cursos Livres">Cursos Livres</button>
                </div>
            </div>
        </section>

        <!-- Grid -->
        <section class="courses-section">
            <div class="container">
                <div class="courses-grid" id="courses-grid">
                    <div class="card-loader">
                        <i class="fas fa-spinner fa-spin fa-2x" style="color:var(--color-secondary)"></i>
                    </div>
                </div>
                <div id="no-results" style="display:none; text-align:center; padding:50px; color:#888;">
                    <i class="far fa-frown fa-3x" style="margin-bottom:20px;"></i>
                    <p>Nenhum curso encontrado nesta categoria.</p>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer id="contato">
        <div class="container footer-social-row"
            style="padding-bottom: 30px; margin-bottom: 40px; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: space-between; align-items: center;">
            <span style="color: #fff; font-size: 1.1rem; font-weight: 500;">Siga-nos nas redes:</span>
            <a href="#" id="social-instagram" data-cms-href="social_instagram" target="_blank" class="social-icon"><i
                    class="fab fa-instagram"></i></a>
            <a href="#" id="social-facebook" data-cms-href="social_facebook" target="_blank" class="social-icon"><i
                    class="fab fa-facebook"></i></a>
            <a href="#" id="social-youtube" data-cms-href="social_youtube" target="_blank" class="social-icon"><i
                    class="fab fa-youtube"></i></a>
            <a href="#" id="social-linkedin" data-cms-href="social_linkedin" target="_blank" class="social-icon"><i
                    class="fab fa-linkedin"></i></a>
        </div>

        <div class="container footer-grid">
            <div class="footer-col">
                <img src="https://cursos.ficv.edu.br/wp-content/uploads/2025/02/logo-ficv.png" alt="FICV Logo Footer"
                    style="filter: brightness(0) invert(1); opacity: 0.7; width: 150px; margin-bottom: 20px;">
                <p id="footer-desc" data-cms-key="footer_desc">Faculdade Internacional Cidade Viva. Transformando vidas
                    através da educação de excelência com
                    princípios cristãos.</p>
            </div>
            <div class="footer-col">
                <h3>Links Rápidos</h3>
                <ul>
                    <li><a href="/">Início</a></li>
                    <li><a href="/cursos">Cursos</a></li>
                    <li><a href="#">Vestibular</a></li>
                    <li><a href="#">Portal do Aluno</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3>Contato</h3>
                <p><i class="fas fa-phone"></i> <span id="footer-phone" data-cms-key="contact_phone">(83)
                        3041-7471</span></p>
                <p><i class="fas fa-envelope"></i> <span id="footer-email"
                        data-cms-key="contact_email">contato@ficv.edu.br</span></p>
                <p><i class="fas fa-map-marker-alt"></i> <span id="footer-address" data-cms-key="contact_address">João
                        Pessoa - PB</span></p>
            </div>
            <div class="footer-col"
                style="display: flex; flex-direction: column; align-items: flex-end; text-align: right;">
                <a href="https://emec.mec.gov.br/emec/consulta-cadastro/detalhamento/d96957f455f6405d14c6542552b0f6eb/MjEyMjQ="
                    target="_blank" id="footer-emec-link" data-cms-href="footer_emec_url">
                    <img src="images/emec-qrcode.png" alt="Consulta e-MEC" style="width: 100px; border-radius: 8px;"
                        id="footer-emec-img" data-cms-key="footer_emec_img">
                </a>
            </div>
        </div>
        <div class="footer-bottom center">
            <p id="footer-copyright" data-cms-key="footer_copyright">&copy; 2025 FICV - Todos os direitos reservados.
            </p>
        </div>
    </footer>

    <!-- Logic -->
    <script type="module" src="/main.js"></script>
    <script type="module">
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm';

        const SUPABASE_URL = 'https://zvfotmlfwglwysqbximn.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp2Zm90bWxmd2dsd3lzcWJ4aW1uIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5NzA2MjEsImV4cCI6MjA4MTU0NjYyMX0.vUTtOAi8bXmDv5t-T0v7Nm1GLPdk1yozLZW-YLn8nG8';
        const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

        let allCourses = [];

        async function init() {
            // Fetch Courses
            const { data, error } = await supabase.from('courses').select('*').order('name');

            if (data) {
                allCourses = data;
                renderCourses(data);
                checkURLParams();
            } else {
                console.error("Error fetching courses", error);
                document.getElementById('courses-grid').innerHTML = '<p>Erro ao carregar cursos.</p>';
            }
        }

        function renderCourses(courses) {
            const grid = document.getElementById('courses-grid');
            if (courses.length === 0) {
                grid.style.display = 'none';
                document.getElementById('no-results').style.display = 'block';
                return;
            } else {
                grid.style.display = 'grid';
                document.getElementById('no-results').style.display = 'none';
            }

            grid.innerHTML = courses.map(c => {
                const isEad = (c.modality && c.modality.toLowerCase().includes('ead')) || (c.level && c.level.toLowerCase().includes('ead'));
                // Determine badges
                let badgeText = c.modality || 'Presencial';
                if (isEad) badgeText = 'EAD'; // Force standard naming if detected
                else badgeText = 'Presencial';

                let badgeHTML = `<span class="badge ${isEad ? 'ead' : 'presencial'}">${badgeText}</span>`;

                // Image fallback
                const img = c.image_url || 'https://via.placeholder.com/400x250?text=Curso+FICV';

                function buildCourseUrl(level, slug) {
                    if (!level) return `/curso/${slug}`;

                    let segment = level.toLowerCase()
                        .normalize("NFD").replace(/[\u0300-\u036f]/g, "")
                        .replace(/[^a-z0-9]/g, '-')
                        .replace(/-+/g, '-')
                        .replace(/^-|-$/g, '');

                    return `/curso/${segment}/${slug}`;
                }

                // URL Construction (Level/Slug)
                let link = buildCourseUrl(c.level, c.slug);

                // Clean level text
                let levelText = c.level || 'Curso';
                // Capitalize first letter logic if needed, but CSS handles standard cases. 
                // However, user image shows "Pós-graduação" (Capitalized first only). 
                // Let's ensure consistent casing in display if DB is messy.
                // Assuming DB returns "Graduação", "Pós-Graduação" etc.

                return `
                <a href="${link}" class="course-card fade-up">
                    <div class="course-image" style="background-image: url('${img}')">
                        <div class="course-badges">
                            ${badgeHTML}
                        </div>
                    </div>
                    <div class="course-content">
                        <div class="course-category">${levelText}</div>
                        <h3 class="course-title">${c.name}</h3>
                    </div>
                </a>
                `;
            }).join('');
        }

        function handleFilter(filter) {
            // Update active tab
            document.querySelectorAll('.filter-tab').forEach(b => {
                if (b.dataset.filter === filter) b.classList.add('active');
                else b.classList.remove('active');
            });

            if (filter === 'all') {
                renderCourses(allCourses);
                return;
            }

            const filtered = allCourses.filter(c => {
                const level = (c.level || '').toLowerCase();
                const modality = (c.modality || '').toLowerCase();
                const name = (c.name || '').toLowerCase();

                if (filter === 'Graduação') {
                    // STRICT: Must be Graduação AND NOT EAD
                    // Also exclude 'Pós' just in case data is messy 
                    return level.includes('graduação') && !level.includes('pós') && !modality.includes('ead');
                }
                if (filter === 'Graduação EAD') {
                    // Must be Graduação AND EAD
                    return level.includes('graduação') && !level.includes('pós') && (modality.includes('ead') || level.includes('ead'));
                }
                if (filter === 'Pós-Graduação') {
                    return level.includes('pós') || name.includes('pós');
                }
                if (filter === 'Cursos Livres') {
                    return level.includes('livre') || level.includes('extensão') || level.includes('aperfeiçoamento');
                }
                return true;
            });

            renderCourses(filtered);
        }

        function checkURLParams() {
            const params = new URLSearchParams(window.location.search);
            const type = params.get('type');
            if (type) {
                let filter = 'all';
                switch (type) {
                    case 'graduacao': filter = 'Graduação'; break;
                    case 'ead': case 'graduacao-ead': filter = 'Graduação EAD'; break;
                    case 'pos': case 'pos-graduacao': filter = 'Pós-Graduação'; break;
                    case 'livres': filter = 'Cursos Livres'; break;
                }
                // Trigger click to animate standard
                const tab = document.querySelector(`.filter-tab[data-filter="${filter}"]`);
                if (tab) {
                    handleFilter(filter); // logic
                    // UI update handled inside handleFilter but let's Ensure
                }
            }
        }

        // Event Listeners
        document.querySelectorAll('.filter-tab').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const filter = e.currentTarget.dataset.filter;
                handleFilter(filter);
            });
        });

        init();

    </script>
</body>

</html>