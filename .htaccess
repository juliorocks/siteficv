RewriteEngine On

# 1. Redirect www to non-www (Optional, good for SEO)
# RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
# RewriteRule ^(.*)$ https://%1/$1 [R=301,L]

# 2. To externally redirect /file.html to /file
RewriteCond %{THE_REQUEST} \s/+(.+?)\.html[\s?] [NC]
RewriteRule ^ /%1 [R=301,L,NE]

# 3. Handle Dynamic Routes (News & Course Details)
# News: /news/slug or /noticias/slug -> news.html
RewriteRule ^news/([^/]+)/?$ news.html [L,QSA]
RewriteRule ^noticias/([^/]+)/?$ news.html [L,QSA]

# Courses: Hierarchical routing
# Priority 1: /curso/level/slug (3 segments) or /curso/slug (2 segments)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^curso/([^/]+)/([^/]+)/?$ curso.html [L,QSA]
RewriteRule ^curso/([^/]+)/?$ curso.html [L,QSA]

# Priority 2: /level/slug (2 segments fallback)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)/([^/]+)/?$ curso.html [L,QSA]

# 4. To internally forward /file to /file.html
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.html -f
RewriteRule ^(.+?)/?$ $1.html [L]
